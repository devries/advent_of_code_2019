package main

import (
	"testing"
)

func TestExecution(t *testing.T) {
	var tests = []struct {
		program string
		input   []int
		output  []int
	}{
		{"3,9,8,9,10,9,4,9,99,-1,8", []int{8}, []int{1}},
		{"3,9,8,9,10,9,4,9,99,-1,8", []int{7}, []int{0}},
		{"3,9,7,9,10,9,4,9,99,-1,8", []int{4}, []int{1}},
		{"3,9,7,9,10,9,4,9,99,-1,8", []int{9}, []int{0}},
		{"3,3,1108,-1,8,3,4,3,99", []int{8}, []int{1}},
		{"3,3,1108,-1,8,3,4,3,99", []int{7}, []int{0}},
		{"3,3,1107,-1,8,3,4,3,99", []int{4}, []int{1}},
		{"3,3,1107,-1,8,3,4,3,99", []int{9}, []int{0}},

		{"3,12,6,12,15,1,13,14,13,4,13,99,-1,0,1,9", []int{0}, []int{0}},
		{"3,12,6,12,15,1,13,14,13,4,13,99,-1,0,1,9", []int{1}, []int{1}},

		{"3,21,1008,21,8,20,1005,20,22,107,8,21,20,1006,20,31," +
			"1106,0,36,98,0,0,1002,21,125,20,4,20,1105,1,46,104," +
			"999,1105,1,46,1101,1000,1,20,4,20,1105,1,46,98,99", []int{7}, []int{999}},
		{"3,21,1008,21,8,20,1005,20,22,107,8,21,20,1006,20,31," +
			"1106,0,36,98,0,0,1002,21,125,20,4,20,1105,1,46,104," +
			"999,1105,1,46,1101,1000,1,20,4,20,1105,1,46,98,99", []int{8}, []int{1000}},
		{"3,21,1008,21,8,20,1005,20,22,107,8,21,20,1006,20,31," +
			"1106,0,36,98,0,0,1002,21,125,20,4,20,1105,1,46,104," +
			"999,1105,1,46,1101,1000,1,20,4,20,1105,1,46,98,99", []int{9}, []int{1001}},
	}

	for _, test := range tests {
		inputOpcodes, err := ParseProgram(test.program)
		if err != nil {
			t.Errorf("Error parsing input: %s", err)
			continue
		}

		var testOutput []int
		err = ExecuteProgram(inputOpcodes, test.input, &testOutput)
		if err != nil {
			t.Errorf("Error executing program: %s", err)
			continue
		}

		if testOutput[0] != test.output[0] {
			t.Errorf("Got %d, expected %d", testOutput[0], test.output[0])
		}
	}
}
